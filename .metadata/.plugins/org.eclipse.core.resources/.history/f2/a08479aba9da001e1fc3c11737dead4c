////package com.example.ata.controller;
////
////import org.modelmapper.ModelMapper;
////import org.springframework.beans.factory.annotation.Autowired;
////import org.springframework.http.HttpHeaders;
////import org.springframework.web.bind.annotation.DeleteMapping;
////import org.springframework.web.bind.annotation.GetMapping;
////import org.springframework.web.bind.annotation.PathVariable;
////import org.springframework.web.bind.annotation.PostMapping;
////import org.springframework.web.bind.annotation.RequestBody;
////import org.springframework.web.bind.annotation.RequestHeader;
////import org.springframework.web.bind.annotation.RequestMapping;
////import org.springframework.web.bind.annotation.RestController;
////
////import com.example.ata.dto.BookingDto;
////import com.example.ata.service.BookingService;
////
////@RestController
////@RequestMapping("/api/booking")
////public class BookingController {
////
////    @Autowired
////    private BookingService bookingService;
////
////    @Autowired
////    private ModelMapper modelMapper;
////    
////    @Autowired
////    private JwtService jwtService; 
////
//////    @PostMapping("/bookings")
//////    public BookingDto saveBooking(@RequestBody BookingDto bookingDto) {
//////        return bookingService.saveBooking(bookingDto);
//////    }
////    @PostMapping("/bookings")
////    public BookingDto saveBooking(@RequestBody BookingDto bookingDto, @RequestHeader(HttpHeaders.AUTHORIZATION) String authorizationHeader) {
////        // Extract JWT token from Authorization header
////        String jwtToken = extractToken(authorizationHeader);
////
////        // Validate and process the JWT token as needed
////        if (jwtService.validateToken(jwtToken)) {
////            // Your logic for saving the booking
////            return bookingService.saveBooking(bookingDto);
////        } else {
////            throw new UnauthorizedException("Invalid token");
////        }
////    }
////
////    private String extractToken(String authorizationHeader) {
////        // Extract the token from the Authorization header (Assuming it is in the format "Bearer <token>")
////        if (authorizationHeader != null && authorizationHeader.startsWith("Bearer ")) {
////            return authorizationHeader.substring(7);
////        }
////        return null;
////    }
////    @DeleteMapping("/deletebooking/{bookingId}")
////    public String cancelBooking(@PathVariable int bookingId) {
////        return bookingService.cancelBooking(bookingId);
////    }
////
////    @GetMapping("/booking-status/{bookingId}")
////    public String viewBookingStatus(@PathVariable("bookingId") int bookingId) {
////        return bookingService.viewBookingStatus(bookingId);
////    }
////
////    @GetMapping("/bookings/{bookingId}")
////    public BookingDto viewBooking(@PathVariable("bookingId") int bookingId) {
////        return bookingService.viewBooking(bookingId);
////    }
////}
//
//package com.example.ata.controller;
//
//import org.modelmapper.ModelMapper;
//import org.springframework.beans.factory.annotation.Autowired;
//import org.springframework.http.HttpHeaders;
//import org.springframework.web.bind.annotation.DeleteMapping;
//import org.springframework.web.bind.annotation.GetMapping;
//import org.springframework.web.bind.annotation.PathVariable;
//import org.springframework.web.bind.annotation.PostMapping;
//import org.springframework.web.bind.annotation.RequestBody;
//import org.springframework.web.bind.annotation.RequestHeader;
//import org.springframework.web.bind.annotation.RequestMapping;
//import org.springframework.web.bind.annotation.RestController;
//
//import com.example.ata.dto.BookingDto;
//import com.example.ata.exception.UnauthorizedException;
//import com.example.ata.service.BookingService;
//import com.example.ata.validatetoken.JwtService;
//
//@RestController
//@RequestMapping("/api/booking")
//public class BookingController{
//
//    @Autowired
//    private BookingService bookingService;
//
//    @Autowired
//    private ModelMapper modelMapper;
//    
//    @Autowired
//    private JwtService jwtService; 
//
//
//    @PostMapping("/bookings")
//    public BookingDto saveBooking(@RequestBody BookingDto bookingDto, @RequestHeader(HttpHeaders.AUTHORIZATION) String authorizationHeader) {
//        // Extract JWT token from Authorization header
//        String jwtToken = extractToken(authorizationHeader);
//
//        // Validate and process the JWT token as needed
//        if (jwtService.validateToken(jwtToken)) {
//            // Your logic for saving the booking
//            return bookingService.saveBooking(bookingDto);
//        } else {
//            throw new UnauthorizedException("Invalid token");
//        }
//    }
//
//    private String extractToken(String authorizationHeader) {
//        // Extract the token from the Authorization header (Assuming it is in the format "Bearer <token>")
//        if (authorizationHeader != null && authorizationHeader.startsWith("Bearer ")) {
//            return authorizationHeader.substring(7);
//        }
//        return null;
//    }
//    @DeleteMapping("/deletebooking/{bookingId}")
//    public String cancelBooking(@PathVariable int bookingId) {
//        return bookingService.cancelBooking(bookingId);
//    }
//
//    @GetMapping("/booking-status/{bookingId}")
//    public String viewBookingStatus(@PathVariable("bookingId") int bookingId) {
//        return bookingService.viewBookingStatus(bookingId);
//    }
//
//    @GetMapping("/bookings/{bookingId}")
//    public BookingDto viewBooking(@PathVariable("bookingId") int bookingId) {
//        return bookingService.viewBooking(bookingId);
//    }
//}


package com.example.ata.controller;

import org.modelmapper.ModelMapper;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.DeleteMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import com.example.ata.dto.BookingDto;
import com.example.ata.service.BookingService;

@RestController
@RequestMapping("/api/booking")
public class BookingController {

    @Autowired
    private BookingService bookingService;

    @Autowired
    private ModelMapper modelMapper;

    @PostMapping("/bookings")
    public BookingDto saveBooking(@RequestBody BookingDto bookingDto) {
        return bookingService.saveBooking(bookingDto);
    }

    @DeleteMapping("/deletebooking/{bookingId}")
    public String cancelBooking(@PathVariable int bookingId) {
        return bookingService.cancelBooking(bookingId);
    }

    @GetMapping("/booking-status/{bookingId}")
    public String viewBookingStatus(@PathVariable("bookingId") int bookingId) {
        return bookingService.viewBookingStatus(bookingId);
    }

    @GetMapping("/bookings/{bookingId}")
    public BookingDto viewBooking(@PathVariable("bookingId") int bookingId) {
        return bookingService.viewBooking(bookingId);
    }
}
